<html>
<head>
<meta charset="UTF-8" />
<link rel="stylesheet" type="text/css" href="../resources/css/footer.css"/>
<script type="text/javascript" src="../resources/javascript/jquery/jquery-2.1.4.min.js">/**/</script>
<script type="text/javascript" src="../resources/javascript/jquery-ui/jquery-ui.min.js">/**/</script>
<link href="../resources/javascript/fancytree/skin-win8/ui.fancytree.min.css" rel="stylesheet" type="text/css">
<script src="../resources/javascript/fancytree/jquery.fancytree-all.min.js" type="text/javascript">/**/</script>
<script type="text/javascript">
	function initialize() {
		$( document ).ready(function() {
			$("#tree").fancytree({
				source: JSON.parse(OxygenAddonBuilder.listFileSystemItems(window.location.search.substring(13),
					"*.framework, addon.xq, **/target, addon-builder.jar, framework.jar, kuberam-addon-templates.css, **/.svn")),
				minExpandLevel: 2,					
				extensions: ["dnd", "edit"],
				dnd: {
				  autoExpandMS: 400,
				  focusOnClick: true,
				  preventVoidMoves: true,
				  preventRecursiveMoves: true,
				  dragStart: function(node, data) {
				    return true;
				  },
				  dragEnter: function(node, data) {
				     return true;
				  },
				  dragDrop: function(node, data) {
				  	var sourceNode = data.otherNode;
				  	OxygenAddonBuilder.move(sourceNode.data.path, node.data.path);
				    sourceNode.moveTo(node, data.hitMode);
				  }
				},				
			    edit: {
			      triggerStart: ["f2", "dblclick", "shift+click", "mac+enter"],
			      beforeEdit: function(event, data){
			      },
			      edit: function(event, data){
			      },
			      beforeClose: function(event, data){
			      },
			      save: function(event, data){
			        OxygenAddonBuilder.rename(data.node.data.path, data.input.val());
			        return true;
			      },
			      close: function(event, data){
			      }
			    }
			});	
		});		
	}
</script>
</head>
<body onload="window.setTimeout(initialize, 0);">
	<h2>Manage framework</h2>
	<ol id="tree"></ol>
	<div id="footer">
		<button style="float: right;" onclick="OxygenAddonBuilder.closeDialogWindow();">Close</button>
	</div>
</body>
</html>
